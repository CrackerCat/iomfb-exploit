#include <stdint.h>

#define g_kernel_shmem_array_len 30
void *g_kernel_shmem[(g_kernel_shmem_array_len*2)+1];

void *(*IOGPUKernelMappedMemory__getKernelData)(void *);

void *_IOGPUKernelMappedMemory__getKernelData(void *a1){
    void *data = IOGPUKernelMappedMemory__getKernelData(a1);

    if(data){
        uint32_t shmem_id = *(uint32_t *)((uintptr_t)data + 0x20);

        if(!g_kernel_shmem[shmem_id])
           g_kernel_shmem[shmem_id] = data; 
    }

    return data;
}
